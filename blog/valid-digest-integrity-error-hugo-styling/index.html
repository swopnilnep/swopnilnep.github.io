<!DOCTYPE html>
<html lang="en-us">

<head>
  <title>Fixing the CSS Integrity Digest Error in Hugo | Swopnil Shrestha | Software Engineer</title>

  <meta charset="UTF-8">
  <meta name="language" content="en">
  <meta name="description" content="How to fix the valid digest ">
  <meta name="keywords" content="hugo , css , styling , integrity , hugo , integrity error , css , not showing , showing on server">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  
  
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Fixing the CSS Integrity Digest Error in Hugo" />
  <meta name="twitter:description" content="How to fix the valid digest "/>
  <meta name="twitter:site" content="https://twitter.com/swopnilnep" />
  <meta name="twitter:creator" content="https://twitter.com/swopnilnep" />
  

  <link rel="shortcut icon" type="image/png" href="/favicon.ico" />


  
  
    
 
  
  
  
  
  
  
    
    <link type="text/css" rel="stylesheet" href="/css/post.min.c3e217b84c00a1ed535efac5536ed3607f886609333f99e716fd1aa58c51a0f8.css" integrity=""/>
  
    
    <link type="text/css" rel="stylesheet" href="/css/custom.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css" integrity=""/>
  
  
   
   
    

<script type="application/ld+json">
  
    {
      "@context" : "http://schema.org",
      "@type" : "BlogPosting",
      "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/swopnil.com"
      },
      "articleSection" : "blog",
      "name" : "Fixing the CSS Integrity Digest Error in Hugo",
      "headline" : "Fixing the CSS Integrity Digest Error in Hugo",
      "description" : "How to fix the valid digest ",
      "inLanguage" : "en-US",
      "author" : "",
      "creator" : "",
      "publisher": "",
      "accountablePerson" : "",
      "copyrightHolder" : "",
      "copyrightYear" : "2021",
      "datePublished": "2021-07-11 20:57:54 -0500 -0500",
      "dateModified" : "2021-07-11 20:57:54 -0500 -0500",
      "url" : "https:\/\/swopnil.com\/blog\/valid-digest-integrity-error-hugo-styling\/",
      "wordCount" : "587",
      "keywords" : ["hugo", "css", "styling", "integrity", "hugo", "integrity error", "css", "not showing", "showing on server", "Blog"]
    }
  
  </script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-131922110-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
</head>

<body>
  <div class="burger__container">
  <div class="burger" aria-controls="navigation" aria-label="Menu">
    <div class="burger__meat burger__meat--1"></div>
    <div class="burger__meat burger__meat--2"></div>
    <div class="burger__meat burger__meat--3"></div>
  </div>
</div>
 

  <nav class="nav" id="navigation">
  <ul class="nav__list">
    
    
      <li>
        <a  href="/">about</a>
      </li>
    
      <li>
        <a  class="active"
         href="/blog">blog</a>
      </li>
    
      <li>
        <a  href="/work">work</a>
      </li>
    
  </ul>
</nav>


  <main>
    
    

    <div class="flex-wrapper">
      <div class="post__container">
        <div class="post">
          <header class="post__header">
            <h1 id="post__title">Fixing the CSS Integrity Digest Error in Hugo</h1>
            <time datetime="2021-07-11 20:57:54 -0500 -0500" class="post__date">Jul 11 2021</time> 
          </header>
          <article class="post__content">
              
<h2 id="issue">Issue<a class="anchor" href="#issue">#</a></h2>
<p>While using Hugo and installing a theme, I encountered this issue. Here are some characteristics.</p>
<p>While using Hugo, the CSS / styling of the page is not loaded, and the page contains just the plain document, with all the HTML as it is in the source code in the deployed website.</p>
<p>On the hugo server, in a new browser session the content loads properly as well as all the related styles / CSS.</p>
<p>Lastly, when opening the browser console on the deployed website, the following error is found:</p>
<pre><code>Failed to find a valid digest in the 'integrity' attribute for resource '***' with computed SHA-256 integrity '***'. The resource has been blocked.
</code></pre>
<h2 id="debugging-the-issue">Debugging the Issue<a class="anchor" href="#debugging-the-issue">#</a></h2>
<p>While researching this issue, for my setup, I noticed there are 3 parts to my pipeline / deployment environment that could have caused this problem. If you use any of these tools for your deployment, you can apply the solution specific to the tools that you are using.</p>
<h3 id="solution-1-cloudflare-cache">Solution 1: CloudFlare Cache<a class="anchor" href="#solution-1-cloudflare-cache">#</a></h3>
<p>Firstly, if you are using CloudFlare as your DNS Provider, this could be a DNS Cache Issue. Although in this case your issue should resolve itself in 24-28 hours automatically.</p>
<p>Nevertheless, you can try the following:</p>
<ol>
<li>
<p>Purge the Cache</p>
<ul>
<li>CloudFlare →  Caching Configurations → Purge Cache</li>
<li>If the root domain is your Hugo website, <strong>Purge Everything</strong></li>
<li>Otherwise, you can selectively purge the subdomains, pages where Hugo is hosted.</li>
</ul>
</li>
<li>
<p>If your theme relies on JavaScript for some styling, disable <strong>RocketLoader</strong> as well in CloudFlare settings</p>
</li>
</ol>
<h3 id="solution-2-git-lf-line-ending">Solution 2: Git LF Line Ending<a class="anchor" href="#solution-2-git-lf-line-ending">#</a></h3>
<p>Depending on which service you are using to host your code and deploy from, you may have run into an issue with Git, where line endings aren&rsquo;t common across development environments. If you are collaborating with someone or you are using multiple systems to commit your code follow this tutorial.</p>
<p>The goal is to automatically use the same character encoding <a href="https://en.wikipedia.org/wiki/Newline" 
  
   target="_blank" rel="noreferrer noopener" 
>CRLF</a> for the newline character. If you are using GitHub.com as your code repository, follow this tutorial, otherwise refer to the relevant server <a href="https://docs.github.com/en/enterprise-server@3.0/get-started/getting-started-with-git/configuring-git-to-handle-line-endings" 
  
   target="_blank" rel="noreferrer noopener" 
>here</a>.</p>
<p>Based on your operating system, run the commands:</p>
<p><small>MacOS / Linux</small></p>
<pre><code class="language-bash">$ git config --global core.autocrlf input
</code></pre>
<p><small>Windows</small></p>
<pre><code>$ git config --global core.autocrlf true
</code></pre>
<p>Next, refresh the repository:</p>
<ol>
<li>
<p>Start by moving all the files (including the hidden . files) from your current folder to a backup folder</p>
</li>
<li>
<p>Add and commit the empty folder</p>
<pre><code>$ git add . -u
$ git commit -m &quot;Empty folder to prepare for line ending fix&quot;

</code></pre>
</li>
<li>
<p>Add back all the moved files from your backup folder</p>
</li>
<li>
<p>Normalize and commit the files</p>
<pre><code>$ git add . --renormalize
$ git commit -m &quot;Normalize all line endings&quot;
</code></pre>
</li>
</ol>
<h3 id="solution-3-remove-integrity-altogether">Solution 3: Remove Integrity Altogether<a class="anchor" href="#solution-3-remove-integrity-altogether">#</a></h3>
<p>The last solution is to remove css file integrity altogether. Although, be warned, you don&rsquo;t want to do this if CORS is a concern for your website.</p>
<p>You can do this by going into the <code>baseof.html</code>. Usually the path to this file is:</p>
<p><code>layouts/_default/baseof.html</code>,</p>
<p>but it may differ based on the theme you are using.</p>
<p>After opening the file,</p>
<ol>
<li>Find the reference link to the CSS file. It looks like the following with integrity enabled:
<pre><code class="language-html">&lt;link rel=&quot;preload&quot; href=&quot;{{ $styles.Permalink }}&quot; integrity=&quot;{{ $styles.Data.Integrity }}&quot; as=&quot;style&quot; crossorigin=&quot;anonymous&quot;&gt;
</code></pre>
</li>
<li>Remove Integrity (replace with empty string)
<pre><code class="language-html">&lt;link rel=&quot;preload&quot; href=&quot;{{ $styles.Permalink }}&quot; integrity=&quot;&quot; as=&quot;style&quot; crossorigin=&quot;anonymous&quot;&gt;
</code></pre>
</li>
<li>You may repeat this for all the resources that are not loading. This will ensure that none of the <code>.css</code> file in your optimized build requires CORS integrity.</li>
</ol>
<h2 id="references">References<a class="anchor" href="#references">#</a></h2>
<ul>
<li><a href="https://docs.github.com/en/get-started/getting-started-with-git/configuring-git-to-handle-line-endings" 
  
   target="_blank" rel="noreferrer noopener" 
>Configuring Git Line Endings | GitHub</a></li>
<li><a href="https://github.com/lxndrblz/anatole/issues/114#issuecomment-828750909" 
  
   target="_blank" rel="noreferrer noopener" 
>Valid Digest Integrity Issue | GitHub</a></li>
<li><a href="https://github.com/alanorth/hugo-theme-bootstrap4-blog/issues/53" 
  
   target="_blank" rel="noreferrer noopener" 
>SHA-256 Integrity Issue</a></li>
</ul>


              
          </article>
          

<ul class="tags__list">
    
    <li class="tag__item">
        <a class="tag__link" href="https://swopnil.com/tags/development-tools/">development-tools</a>
    </li>
    <li class="tag__item">
        <a class="tag__link" href="https://swopnil.com/tags/hugo/">hugo</a>
    </li></ul>

 <div class="pagination">
  
    <a class="pagination__item" href="https://swopnil.com/blog/tensorflow-introduction-to-machine-learning/">
        <span class="pagination__label">Previous Post</span>
        <span class="pagination__title">TensorFlow: Introduction to Machine Learning</span>
    </a>
  

  
    <a class="pagination__item" href="https://swopnil.com/blog/homebrew-remove-all-dependencies-for-a-package/">
      <span class="pagination__label">Next Post</span>
      <span class="pagination__title" >Homebrew: Remove All Dependencies for a Package</span>
    </a>
  
</div>

          
          <footer class="post__footer">
            


<div class="social-icons">
  
     
    
      <a
        class="social-icons__link"
        title="LinkedIn"
        href="https://linkedin.com/in/swopnilnep"
        target="_blank"
        rel="me noopener"
      >
        <div class="social-icons__icon" style="background-image: url('https://swopnil.com/svg/linkedin.svg')"></div>
      </a>
    
  
     
    
      <a
        class="social-icons__link"
        title="GitHub"
        href="https://github.com/swopnilnep"
        target="_blank"
        rel="me noopener"
      >
        <div class="social-icons__icon" style="background-image: url('https://swopnil.com/svg/github.svg')"></div>
      </a>
    
  
     
    
      <a
        class="social-icons__link"
        title="Twitter"
        href="https://twitter.com/swopnilnep"
        target="_blank"
        rel="me noopener"
      >
        <div class="social-icons__icon" style="background-image: url('https://swopnil.com/svg/twitter.svg')"></div>
      </a>
    
  
     
    
     
</div>

            <p>© Swopnil Shrestha 2022</p>
          </footer>
          </div>
      </div>
      
    </div>
    

  </main>

   

  
  <script src="/js/index.min.575dda8d49ee02639942c63564273e6da972ab531dda26a08800bdcb477cbd7f.js" integrity="sha256-V13ajUnuAmOZQsY1ZCc&#43;balyq1Md2iagiAC9y0d8vX8=" crossorigin="anonymous"></script>
  
  
  <script src="https://unpkg.com/prismjs@1.20.0/components/prism-core.min.js"></script>

  
  <script src="https://unpkg.com/prismjs@1.20.0/plugins/autoloader/prism-autoloader.min.js"
    data-autoloader-path="https://unpkg.com/prismjs@1.20.0/components/"></script>

  


</body>

</html>
